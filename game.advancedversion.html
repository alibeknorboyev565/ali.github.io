<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ultimate Memory Match Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #74ebd5, #9face6);
      margin: 0;
      padding: 0;
      transition: background 0.5s, color 0.5s;
    }
    body.dark-mode {
      background: #222;
      color: #fff;
    }
    h1 {
      margin: 20px 0;
    }
    #gameBoard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 10px;
      justify-content: center;
      margin: 20px auto;
      max-width: 450px;
    }
    .card {
      width: 100%;
      height: 100px;
      background: #333;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: transparent;
      transition: background 0.3s, color 0.3s;
      perspective: 600px;
    }
    .cardInner {
      transition: transform 0.5s;
      transform-style: preserve-3d;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      background: inherit;
    }
    .card.flipped .cardInner {
      transform: rotateY(180deg);
      background: #fff;
      color: #000;
    }
    .match-animation {
      animation: pop 0.5s ease forwards;
    }
    @keyframes pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    #menu, #gameScreen, #endScreen {
      display: none;
    }
    #stats {
      margin: 10px 0;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 6px;
      border: none;
      background: #0077cc;
      color: white;
      transition: background 0.3s;
    }
    button:hover {
      background: #005fa3;
    }
    .chat-link {
      display: block;
      margin: 10px 0;
      font-size: 0.95em;
      color: #0077cc;
      text-decoration: none;
    }
    .chat-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>Ultimate Memory Match Game</h1>

  <!-- MENU -->
  <div id="menu">
    <a href="https://chatgpt.com/share/68d38845-bb18-8011-a3a8-1da20eb4d77f" 
       target="_blank" class="chat-link">ðŸ“„ Open Conversation in New Tab</a>
    <h2>Enter Player Name</h2>
    <input id="playerName" placeholder="Your Name">
    <button onclick="startSinglePlayer()">Start Single Player</button>
    <button onclick="startMultiplayer()">Start Multiplayer</button>
    <button onclick="toggleDarkMode()">ðŸŒ™ Toggle Dark Mode</button>
  </div>

  <!-- GAME SCREEN -->
  <div id="gameScreen">
    <div id="stats">
      <span id="currentPlayer"></span>
      <span id="moves"></span>
      <span id="timer"></span>
    </div>
    <div id="gameBoard"></div>
    <button onclick="resetGame()">Restart</button>
  </div>

  <!-- END SCREEN -->
  <div id="endScreen">
    <h2 id="result"></h2>
    <button onclick="showMenu()">Back to Menu</button>
  </div>

  <!-- Sounds -->
  <audio id="flipSound" src="https://freesound.org/data/previews/170/170664_2437358-lq.mp3"></audio>
  <audio id="matchSound" src="https://freesound.org/data/previews/109/109662_945474-lq.mp3"></audio>
  <audio id="winSound" src="https://freesound.org/data/previews/331/331912_3248244-lq.mp3"></audio>

  <script>
    const cardsArray = ['ðŸŽ','ðŸŒ','ðŸ‡','ðŸ’','ðŸ‰','ðŸ','ðŸ¥','ðŸ‘'];
    const gameBoard = document.getElementById("gameBoard");
    const menu = document.getElementById("menu");
    const gameScreen = document.getElementById("gameScreen");
    const endScreen = document.getElementById("endScreen");
    const movesSpan = document.getElementById("moves");
    const timerSpan = document.getElementById("timer");
    const currentPlayerSpan = document.getElementById("currentPlayer");
    const playerNameInput = document.getElementById("playerName");

    const flipSound = document.getElementById("flipSound");
    const matchSound = document.getElementById("matchSound");
    const winSound = document.getElementById("winSound");

    let flippedCards = [];
    let matchedPairs = 0;
    let moves = 0;
    let timer;
    let timeElapsed = 0;
    let multiplayer = false;
    let currentPlayer = 0;
    let players = [];
    let scores = [];

    function showMenu() {
      menu.style.display = "block";
      gameScreen.style.display = "none";
      endScreen.style.display = "none";
    }

    function startSinglePlayer() {
      multiplayer = false;
      players = [playerNameInput.value || "Player"];
      currentPlayer = 0;
      startGame();
    }

    function startMultiplayer() {
      multiplayer = true;
      players = [playerNameInput.value || "Player 1", "Player 2"];
      currentPlayer = 0;
      startGame();
    }

    function startGame() {
      menu.style.display = "none";
      gameScreen.style.display = "block";
      endScreen.style.display = "none";
      scores = players.map(() => 0);
      resetStats();
      createBoard();
      startTimer();
      updateScores();
    }

    function resetStats() {
      flippedCards = [];
      matchedPairs = 0;
      moves = 0;
      timeElapsed = 0;
      movesSpan.textContent = "Moves: 0";
      currentPlayerSpan.textContent = "Turn: " + players[currentPlayer];
    }

    function createBoard() {
      const doubleCards = [...cardsArray, ...cardsArray].sort(() => 0.5 - Math.random());
      gameBoard.innerHTML = "";
      doubleCards.forEach(symbol => {
        const card = document.createElement("div");
        card.classList.add("card");
        const inner = document.createElement("div");
        inner.classList.add("cardInner");
        inner.textContent = symbol;
        card.appendChild(inner);
        card.addEventListener("click", flipCard);
        gameBoard.appendChild(card);
      });
    }

    function flipCard() {
      if (this.classList.contains("flipped") || flippedCards.length === 2) return;
      flipSound.play();
      this.classList.add("flipped");
      flippedCards.push(this);
      if (flippedCards.length === 2) {
        moves++;
        movesSpan.textContent = "Moves: " + moves;
        checkMatch();
      }
    }

    function checkMatch() {
      const [card1, card2] = flippedCards;
      const symbol1 = card1.querySelector('.cardInner').textContent;
      const symbol2 = card2.querySelector('.cardInner').textContent;

      if (symbol1 === symbol2) {
        matchedPairs++;
        matchSound.play();
        card1.classList.add("match-animation");
        card2.classList.add("match-animation");
        if (multiplayer) scores[currentPlayer]++;
        flippedCards = [];
        updateScores();
        if (matchedPairs === cardsArray.length) endGame();
      } else {
        setTimeout(() => {
          card1.classList.remove("flipped");
          card2.classList.remove("flipped");
          flippedCards = [];
          if (multiplayer) switchTurn();
          updateScores();
        }, 800);
      }
    }

    function switchTurn() {
      currentPlayer = (currentPlayer + 1) % players.length;
    }

    function updateScores() {
      if (multiplayer) {
        currentPlayerSpan.textContent = players.map((p, i) => `${p}: ${scores[i]}`).join(" | ") + ` | Turn: ${players[currentPlayer]}`;
      } else {
        currentPlayerSpan.textContent = "Player: " + players[0];
      }
    }

    function startTimer() {
      clearInterval(timer);
      timer = setInterval(() => {
        timeElapsed++;
        timerSpan.textContent = "Time: " + timeElapsed + "s";
      }, 1000);
    }

    function endGame() {
      clearInterval(timer);
      winSound.play();
      gameScreen.style.display = "none";
      endScreen.style.display = "block";
      let winnerText;
      if (multiplayer) {
        const maxScore = Math.max(...scores);
        const winners = players.filter((p, i) => scores[i] === maxScore);
        winnerText = winners.length === 1 ? `${winners[0]} wins!` : `It's a tie!`;
      } else {
        winnerText = `${players[0]} finished!`;
      }
      document.getElementById("result").textContent = `ðŸŽ‰ ${winnerText} Moves: ${moves}, Time: ${timeElapsed}s`;
    }

    function resetGame() {
      startGame();
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
      localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    }

    // Load dark mode preference
    if (localStorage.getItem("darkMode") === "true") {
      document.body.classList.add("dark-mode");
    }

    showMenu();
  </script>
</body>
</html>
